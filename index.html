<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>week12</title>
</head>
<body>
<form id="form">
    <div>Оставьте ваш комментарий</div>
    <label>
        <input type="checkbox" name="" id="showName">
        Не показывать мой никнейм
    </label>
    <br>
    <br>

    <input id="textInput" class="name" type="text" size="40"/>
    <input id="textInput2" type="text" size="40"/>
    <input id="textInput3" type="text" size="40"/>
    <button>Отправить</button>
    <div id="showArea">
</form>
</div>

<script>

  function formatName(str) {
    let result = str.trim()

    if (result === "") {
      return "username"
    }

    let arr = result.split(" ")

    arr = arr.map(
      (element) => element[0].toUpperCase() + element.slice(1).toLowerCase(),
    )

    return arr.join(" ")
  }

  function randomIntFromInterval(min, max) {
    return Math.floor(Math.random() * (max - min + 1) + min)
  }

  function showImage(src) {
    let image = document.createElement("img")
    image.src = src

    const container = document.getElementById("showArea")

    const date = new Date()
    let notShow = document.getElementById("showName")

    if (src === "") {
      function pict(src, ind) {
        let imgs = [

          "https://www.icenews.is/wp-content/uploads/2015/02/animals-1-700x700.jpg",

          "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcShZghyt2L03zlqdj_6F7EPbCCsWWnAcVsvJ3_xv7cc-IraZc-o",

          "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTdPEJ0n_tXI0No_5AgkeVpzomxp4mI8jlQv3rsKQQHNh671QU_",


        ]

        const index = randomIntFromInterval(0, imgs.length - 1)
        return imgs[index] ? imgs[index] : ""

      }

      if (notShow.checked) {
        container.append(image, "username", " ", date.toDateString(), checkSpam(input3.value))
      } else {
        image.src = pict(input2.value);
        image.width = 300;
        image.height = 300;
        container.append(image," ",formatName(input.value), " ", date.toDateString(), " ", checkSpam(input3.value))
      }
    }
    else {
      if (notShow.checked) {
        container.append(image," ", "username", " ", date.toDateString(), " ",checkSpam(input3.value))
      } else {
        container.append(image," ", formatName(input.value), " ", date.toDateString(), " ",checkSpam(input3.value))
      }
    }
  }

  function checkSpam(str) {
    let pattern = /viagra/gi

    return str.replace(pattern, "***")
  }

  const input = document.getElementById("textInput")
  const input2 = document.getElementById("textInput2")
  const input3 = document.getElementById("textInput3")
  const button = document.querySelector("button")

  button.addEventListener("click", (evt) => {
    debugger
    console.log(formatName(input.value))
    showImage(input2.value)
    console.log(checkSpam(input3.value))

    input.value = ""
    input2.value = ""
    input3.value = ""
    evt.preventDefault();
  })


  const str = "!***! <div id=\"tera\">Тут крайне <a href=\"link\">интересная и весьма</a></div>нужная информация."

  function deleteTags(str) {
    const regex = /( |<([^>]+)>)/ig,
      result = str.replace(regex, "")

    return result
  }
  debugger
  console.log(deleteTags(str))
</script>
</body>
</html>